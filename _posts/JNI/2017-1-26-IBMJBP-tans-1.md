---
layout: post
title: IBM 良心文章翻译
category: JNI
tags: Java
keywords: Java,JNI,C++
description: JNI Tutorial
---

java 这个语言本身，以及它的环境在应用开发上是安全有效的。

然而，一些应用程序需要执行的任务，不是一个纯粹的 java 程序就可以完成的，比如：

+ 与现有遗留代码结合到一起以避免重复造轮子/重写已有类库。
+ 可用的类库中的实现缺少相应的功能。例如，如果你想拿 java 实现 ping ，但 java 自带的类库没有提供。
+ 你需要在一些特定环境下实现高效率的代码，比如 CUDA ，比如你需要使用矩阵运算。
+ 解决一些特殊情况需要非 java 代码。例如，核心类库的实现可能需要跨包调用，或者需要绕过其他 java 安全检查。
+ 对绕过 JVM 的 GC 系统的欲望太强导致欲火焚身。

JNI 允许您完成这些任务。它提供了 java 代码和本地代码的执行之间的完全分离（如 C 或 C++ ）通过定义两者之间传递一个清晰的 API 。最重要的是，它避免了本地代码直接引用的内存到 JVM ，保证人可以写一次，工作在不同的 JVM 实现或版本。

JNI 自从 JDK 1.1 发布后就是 java 平台的一部分了，在 JDK 1.2 发布了扩展，可以自己写 JNI 函数了。

JDK 1 发布包括早期的本地方法接口，缺乏原生代码和 java 代码之间的优雅的解耦。
在这个接口中，本地方法会直接接触到 JVM 结构，所以这破玩意不能在别的 JVM 的实现、可移植的平台、或甚至不同版本的 JDK 里面用（所以这是辣鸡）。

JNI 本地代码是非常自由的，用 java 对象之间的相互关系，获取和设置成员变量的值，调用一些 java 方法，并不受一些 java 所受的制约的影响。

这种自由是一把双刃剑： 它交易安全的 java 语言完成任务的能力，上市前。在你的应用程序提供了强大的底层访问本机的资源使用 JNI （内存、 I/O 等），那么你的工作没有提供安全网通常是 java 开发者。 JNI 的灵活性和功能介绍的编程实践，会导致不良的表现，错误的风险，甚至程序崩溃。您必须小心您的应用程序中包含的代码，并使用良好的实践来维护应用程序的整体完整性。

本文介绍了 10 种最常见的编码， JNI 用户设计错误。你的目标是帮助识别和避开他们，你可以写安全、高效的 JNI 代码执行从一开始。本文还介绍了现有的工具和技术，发现这些问题在新的或现有的代码，并显示如何有效地应用它们。
JNI 编程缺陷分为两类：
性能：代码执行设计的功能，但这样做缓慢或以某种方式，导致整体程序减慢。
正确性：代码工作的时间，但不可靠地提供所需的功能，在最坏的情况下，它崩溃或挂起。 
